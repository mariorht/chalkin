services:
  api:
    build: ./src
    container_name: chalkin_api
    environment:
      # App Settings
      - APP_NAME=${APP_NAME:-Chalkin}
      - APP_VERSION=${APP_VERSION:-0.1.0}
      - DEBUG=${DEBUG:-true}
      # Database
      - DATABASE_URL=${DATABASE_URL:-sqlite:///./chalkin.db}
      # Data directory
      - DATA_DIR=/app/data
      # JWT Auth
      - SECRET_KEY=${SECRET_KEY:-dev-secret-key-change-in-production}
      - ALGORITHM=${ALGORITHM:-HS256}
      - ACCESS_TOKEN_EXPIRE_MINUTES=${ACCESS_TOKEN_EXPIRE_MINUTES:-10080}
      # File Uploads
      - UPLOAD_DIR=${UPLOAD_DIR:-uploads}
      - MAX_FILE_SIZE=${MAX_FILE_SIZE:-5242880}
      # Web Push
      - VAPID_PUBLIC_KEY=${VAPID_PUBLIC_KEY:-}
      - VAPID_PRIVATE_KEY=${VAPID_PRIVATE_KEY:-}
      - VAPID_SUBJECT=${VAPID_SUBJECT:-mailto:support@example.com}
    ports:
      - "8001:8001"
    volumes:
      - ./src:/app
      - chalkin_data:/app/data
    restart: unless-stopped

volumes:
  chalkin_data:
